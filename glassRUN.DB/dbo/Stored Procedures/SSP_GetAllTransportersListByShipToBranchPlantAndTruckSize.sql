CREATE PROCEDURE [dbo].[SSP_GetAllTransportersListByShipToBranchPlantAndTruckSize] @xmlDoc XMLASBEGINDECLARE @intPointer INT;Declare @companyId bigint;Declare @TruckSizeId bigint;Declare @CollectionLocationCode nvarchar(50);EXEC sp_xml_preparedocument @intpointer OUTPUT,@xmlDocSELECT @companyId = tmp.[CompanyId],       @TruckSizeId = tmp.[TruckSizeId],	   @CollectionLocationCode = tmp.[CollectionLocationCode]FROM OPENXML(@intpointer,'Json',2)			WITH			(			[CompanyId] bigint,			[TruckSizeId] bigint,			[CollectionLocationCode] nvarchar(50)			)tmp ;Declare @LocationId bigint;Select @LocationId=LocationId from [Location] where LocationCode = @CollectionLocationCode;			WITH XMLNAMESPACES('http://james.newtonking.com/projects/json' AS json) SELECT CAST((SELECT 'true' AS [@json:Array] , c.CompanyId As CarrierId, c.CompanyMnemonic As CarrierCode, c.CompanyName As CarrierName from Route r
INNER JOIN Company c on r.CarrierNumber = c.CompanyId and c.CompanyType = 28
where r.DestinationId = @companyId and r.TruckSizeId = @TruckSizeId and r.OriginId = @LocationId and r.IsActive = 1	FOR XML path('TransporterList'),ELEMENTS,ROOT('Json')) AS XML)END