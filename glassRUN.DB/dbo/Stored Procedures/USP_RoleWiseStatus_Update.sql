-----------------------------------------------------------------
-- UPDATE BY PRIMARY KEY
-- Date Created: Monday, March 16, 2015
-- Created By:   Nimish
-- Procedure to update entries in the dbo.EmailContent table
-----------------------------------------------------------------
 
CREATE PROCEDURE [dbo].[USP_RoleWiseStatus_Update] --'<Json><ServicesAction>UpdateRoleWiseStatus</ServicesAction><ActivityList><ActivityId>1</ActivityId><StatusCode>1</StatusCode><Header>Enquiry</Header><ActivityName>Create Enquiry</ActivityName><Sequence>1</Sequence><ServiceAction>SaveEnquiry</ServiceAction><RoleMasterId>1</RoleMasterId></ActivityList><ActivityList><ActivityId>2</ActivityId><StatusCode>320</StatusCode><Header>Enquiry </Header><ActivityName>Enquiry Approval By Order Admin</ActivityName><Sequence>2</Sequence><ServiceAction>UpdateEnquiryStatusByEnquiryId</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>333</RoleWiseStatusId><ResourceKey>res_320_1</ResourceKey><CultureList><ResourceId>37004</ResourceId><ResourceKey>res_320_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Awating Approval from Order Admindfsfsfsfs</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37368</ResourceId><ResourceKey>res_320_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Awating Approval from Order Admin</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>3</ActivityId><StatusCode>340</StatusCode><Header>Enquiry</Header><ActivityName>Enquiry Approval By Finance Controller</ActivityName><Sequence>5</Sequence><ServiceAction>UpdateEnquiryStatusByEnquiryId</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>346</RoleWiseStatusId><ResourceKey>res_340_1</ResourceKey><CultureList><ResourceId>37017</ResourceId><ResourceKey>res_340_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Awating Approval from Finance</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37381</ResourceId><ResourceKey>res_340_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Awating Approval from Finance</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>10</ActivityId><StatusCode>360</StatusCode><Header>Enquiry</Header><ActivityName>Enquiry Approval By Delivery Manager</ActivityName><Sequence>6</Sequence><ServiceAction>UpdateEnquiryStatusByEnquiryId</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>359</RoleWiseStatusId><ResourceKey>res_360_1</ResourceKey><CultureList><ResourceId>37030</ResourceId><ResourceKey>res_360_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Awating Approval from Delivery Manager</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37394</ResourceId><ResourceKey>res_360_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Awating Approval from Delivery Manager</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>11</ActivityId><StatusCode>520</StatusCode><Header>Order</Header><ActivityName>Order creation</ActivityName><Sequence>1</Sequence><ServiceAction>ApproveEnquiryForOrder</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>372</RoleWiseStatusId><ResourceKey>res_520_1</ResourceKey><CultureList><ResourceId>37043</ResourceId><ResourceKey>res_520_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Order Created</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37407</ResourceId><ResourceKey>res_520_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Order Created</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>12</ActivityId><StatusCode>525</StatusCode><Header>Order</Header><ActivityName>Planning</ActivityName><Sequence>2</Sequence><ServiceAction>UpdateEnquiryStatusByEnquiryId</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>385</RoleWiseStatusId><ResourceKey>res_525_1</ResourceKey><CultureList><ResourceId>37056</ResourceId><ResourceKey>res_525_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Order Scheduled</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37420</ResourceId><ResourceKey>res_525_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Order Scheduled</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>13</ActivityId><StatusCode>540</StatusCode><Header>Order</Header><ActivityName>Pick Confirm</ActivityName><Sequence>3</Sequence><ServiceAction>ApproveEnquiry</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>398</RoleWiseStatusId><ResourceKey>res_540_1</ResourceKey><CultureList><ResourceId>37069</ResourceId><ResourceKey>res_540_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Pick Confirmed</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37433</ResourceId><ResourceKey>res_540_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Pick Confirmed</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>14</ActivityId><StatusCode>545</StatusCode><Header>Order</Header><ActivityName>Collection</ActivityName><Sequence>4</Sequence><ServiceAction>SaveEnquiry</ServiceAction><RoleMasterId>1</RoleMasterId></ActivityList><ActivityList><ActivityId>15</ActivityId><StatusCode>560</StatusCode><Header>Order</Header><ActivityName>Ship Confirmation</ActivityName><Sequence>5</Sequence><ServiceAction>UpdateEnquiryStatusByEnquiryId</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>411</RoleWiseStatusId><ResourceKey>res_560_1</ResourceKey><CultureList><ResourceId>37082</ResourceId><ResourceKey>res_560_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Ship Confirmation</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37446</ResourceId><ResourceKey>res_560_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Ship Confirmation</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>16</ActivityId><StatusCode>580</StatusCode><Header>Order</Header><ActivityName>Invoice Generation</ActivityName><Sequence>6</Sequence><ServiceAction>ApproveEnquiry</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>424</RoleWiseStatusId><ResourceKey>res_580_1</ResourceKey><CultureList><ResourceId>37095</ResourceId><ResourceKey>res_580_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Invoice Generation</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37459</ResourceId><ResourceKey>res_580_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Invoice Generation</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>17</ActivityId><StatusCode>325</StatusCode><Header>Enquiry</Header><ActivityName>Enquiry Approval by Area Manager</ActivityName><Sequence>3</Sequence><ServiceAction>UpdateEnquiryStatusByEnquiryId</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>437</RoleWiseStatusId><ResourceKey>res_325_1</ResourceKey><CultureList><ResourceId>37108</ResourceId><ResourceKey>res_325_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Awating Approval from Area Manager</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37472</ResourceId><ResourceKey>res_325_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Awating Approval from Area Manager</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>18</ActivityId><StatusCode>330</StatusCode><Header>Enquiry</Header><ActivityName>Enquiry Approval by Zone Manager</ActivityName><Sequence>3</Sequence><ServiceAction>UpdateEnquiryStatusByEnquiryId</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>450</RoleWiseStatusId><ResourceKey>res_330_1</ResourceKey><CultureList><ResourceId>37121</ResourceId><ResourceKey>res_330_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Awating Approval from Zone Manager</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37485</ResourceId><ResourceKey>res_330_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Awating Approval from Zone Manager</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>19</ActivityId><StatusCode>990</StatusCode><Header>Enquiry</Header><ActivityName>Enquiry Rejected by Person A</ActivityName><Sequence>4</Sequence><ServiceAction>UpdateEnquiryStatusByEnquiryId</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>463</RoleWiseStatusId><ResourceKey>res_990_1</ResourceKey><CultureList><ResourceId>37134</ResourceId><ResourceKey>res_990_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Enquiry Rejected</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37498</ResourceId><ResourceKey>res_990_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Enquiry Rejected</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>101</ActivityId><StatusCode>100</StatusCode><Header>Collection</Header><ActivityName>Track Collection Start time</ActivityName><Sequence>1</Sequence><ServiceAction>COllected</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>476</RoleWiseStatusId><ResourceKey>res_100_1</ResourceKey><CultureList><ResourceId>37147</ResourceId><ResourceKey>res_100_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collection Scheduled</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37511</ResourceId><ResourceKey>res_100_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collection Scheduled</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>102</ActivityId><StatusCode>1001</StatusCode><Header>Collection</Header><ActivityName>Capture Planned Vs Actual Collection</ActivityName><Sequence>2</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>489</RoleWiseStatusId><ResourceKey>res_1001_1</ResourceKey><CultureList><ResourceId>37160</ResourceId><ResourceKey>res_1001_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collection In Progress</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37524</ResourceId><ResourceKey>res_1001_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collection In Progress</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>103</ActivityId><StatusCode>1002</StatusCode><Header>Collection</Header><ActivityName>View Actual Collection</ActivityName><Sequence>3</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>502</RoleWiseStatusId><ResourceKey>res_1002_1</ResourceKey><CultureList><ResourceId>37173</ResourceId><ResourceKey>res_1002_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collection In Progress</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37537</ResourceId><ResourceKey>res_1002_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collection In Progress</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>104</ActivityId><StatusCode>1003</StatusCode><Header>Collection</Header><ActivityName>Loose Assets</ActivityName><Sequence>4</Sequence><ServiceAction>COllected</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>515</RoleWiseStatusId><ResourceKey>res_1003_1</ResourceKey><CultureList><ResourceId>37186</ResourceId><ResourceKey>res_1003_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collection In Progress</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37550</ResourceId><ResourceKey>res_1003_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collection In Progress</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>105</ActivityId><StatusCode>1004</StatusCode><Header>Collection</Header><ActivityName>Checklist/Survey at time of Collection</ActivityName><Sequence>5</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>528</RoleWiseStatusId><ResourceKey>res_1004_1</ResourceKey><CultureList><ResourceId>37199</ResourceId><ResourceKey>res_1004_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collection In Progress</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37563</ResourceId><ResourceKey>res_1004_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collection In Progress</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>106</ActivityId><StatusCode>1005</StatusCode><Header>Collection</Header><ActivityName>Record Collection Confirmation</ActivityName><Sequence>6</Sequence><ServiceAction>COllected</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>541</RoleWiseStatusId><ResourceKey>res_1005_1</ResourceKey><CultureList><ResourceId>37212</ResourceId><ResourceKey>res_1005_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collection In Progress</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37576</ResourceId><ResourceKey>res_1005_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collection In Progress</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>107</ActivityId><StatusCode>101</StatusCode><Header>Collection</Header><ActivityName>Capture the actual Collection time</ActivityName><Sequence>7</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>554</RoleWiseStatusId><ResourceKey>res_101_1</ResourceKey><CultureList><ResourceId>37225</ResourceId><ResourceKey>res_101_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collected</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37589</ResourceId><ResourceKey>res_101_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Collected</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>108</ActivityId><StatusCode>102</StatusCode><Header>Delivery</Header><ActivityName>Track Delivery Start time</ActivityName><Sequence>1</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>567</RoleWiseStatusId><ResourceKey>res_102_1</ResourceKey><CultureList><ResourceId>37238</ResourceId><ResourceKey>res_102_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery Scheduled</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37602</ResourceId><ResourceKey>res_102_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery Scheduled</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>109</ActivityId><StatusCode>1021</StatusCode><Header>Delivery</Header><ActivityName>Capture Planned Vs Actual Delivery</ActivityName><Sequence>2</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>580</RoleWiseStatusId><ResourceKey>res_1021_1</ResourceKey><CultureList><ResourceId>37251</ResourceId><ResourceKey>res_1021_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37615</ResourceId><ResourceKey>res_1021_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>110</ActivityId><StatusCode>1022</StatusCode><Header>Delivery</Header><ActivityName>View Actual Delivery</ActivityName><Sequence>3</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>593</RoleWiseStatusId><ResourceKey>res_1022_1</ResourceKey><CultureList><ResourceId>37264</ResourceId><ResourceKey>res_1022_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37628</ResourceId><ResourceKey>res_1022_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>111</ActivityId><StatusCode>1023</StatusCode><Header>Delivery</Header><ActivityName>Pre-Delivery Checklist</ActivityName><Sequence>4</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>606</RoleWiseStatusId><ResourceKey>res_1023_1</ResourceKey><CultureList><ResourceId>37277</ResourceId><ResourceKey>res_1023_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37641</ResourceId><ResourceKey>res_1023_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>112</ActivityId><StatusCode>1024</StatusCode><Header>Delivery</Header><ActivityName>Capture Return Packaging Material</ActivityName><Sequence>5</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>619</RoleWiseStatusId><ResourceKey>res_1024_1</ResourceKey><CultureList><ResourceId>37290</ResourceId><ResourceKey>res_1024_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37654</ResourceId><ResourceKey>res_1024_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>113</ActivityId><StatusCode>1025</StatusCode><Header>Delivery</Header><ActivityName>Loose Assets Delivery </ActivityName><Sequence>7</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>632</RoleWiseStatusId><ResourceKey>res_1025_1</ResourceKey><CultureList><ResourceId>37303</ResourceId><ResourceKey>res_1025_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37667</ResourceId><ResourceKey>res_1025_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>114</ActivityId><StatusCode>1026</StatusCode><Header>Delivery</Header><ActivityName>Checklist/Survey at time of delivery</ActivityName><Sequence>8</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>645</RoleWiseStatusId><ResourceKey>res_1026_1</ResourceKey><CultureList><ResourceId>37316</ResourceId><ResourceKey>res_1026_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37680</ResourceId><ResourceKey>res_1026_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>115</ActivityId><StatusCode>1027</StatusCode><Header>Delivery</Header><ActivityName>Record Delivery Confirmation</ActivityName><Sequence>9</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>658</RoleWiseStatusId><ResourceKey>res_1027_1</ResourceKey><CultureList><ResourceId>37329</ResourceId><ResourceKey>res_1027_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37693</ResourceId><ResourceKey>res_1027_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivery In Progress</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>116</ActivityId><StatusCode>103</StatusCode><Header>Delivery</Header><ActivityName>Capture the actual Delivery time</ActivityName><Sequence>10</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>671</RoleWiseStatusId><ResourceKey>res_103_1</ResourceKey><CultureList><ResourceId>37342</ResourceId><ResourceKey>res_103_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivered</ResourceValue><Name>English</Name></CultureList><CultureList><ResourceId>37706</ResourceId><ResourceKey>res_103_1</ResourceKey><RoleName>Admin</RoleName><RoleMasterId>1</RoleMasterId><ResourceValue>Delivered</ResourceValue><Name>Hindi</Name></CultureList></ActivityList><ActivityList><ActivityId>117</ActivityId><StatusCode>117</StatusCode><Header>Enquiry</Header><ActivityName>Enquiry</ActivityName><Sequence>1</Sequence><ServiceAction>SaveEnquiry</ServiceAction><RoleMasterId>1</RoleMasterId></ActivityList><ActivityList><ActivityId>118</ActivityId><StatusCode>118</StatusCode><Header>Order</Header><ActivityName>Order</ActivityName><Sequence>2</Sequence><ServiceAction>SaveEnquiry</ServiceAction><RoleMasterId>1</RoleMasterId></ActivityList><ActivityList><ActivityId>120</ActivityId><StatusCode>120</StatusCode><Header>Collection</Header><ActivityName>Collection</ActivityName><Sequence>3</Sequence><ServiceAction>SaveEnquiry</ServiceAction><RoleMasterId>1</RoleMasterId></ActivityList><ActivityList><ActivityId>121</ActivityId><StatusCode>121</StatusCode><Header>Delivery</Header><ActivityName>Delivery</ActivityName><Sequence>4</Sequence><ServiceAction>SaveEnquiry</ServiceAction><RoleMasterId>1</RoleMasterId></ActivityList><ActivityList><ActivityId>122</ActivityId><StatusCode>1028</StatusCode><Header>Delivery</Header><ActivityName>Lorry Receipt</ActivityName><Sequence>6</Sequence><ServiceAction>Delivered</ServiceAction><RoleMasterId>1</RoleMasterId><RoleWiseStatusId>684</RoleWiseStatusId><ResourceKey>res_1028_1</ResourceKey></ActivityList><ActivityList><ActivityId>123</ActivityId><RoleMasterId>1</RoleMasterId></ActivityList><ActivityList><ActivityId>124</ActivityId><RoleMasterId>1</RoleMasterId></ActivityList><ActivityList><ActivityId>125</ActivityId><RoleMasterId>1</RoleMasterId></ActivityList><ActivityList><ActivityId>126</ActivityId><RoleMasterId>1</RoleMasterId></ActivityList></Json>'

@xmlDoc xml
AS
BEGIN 
	SET ARITHABORT ON 
	DECLARE @TranName NVARCHAR(max)
	DECLARE @ErrMsg NVARCHAR(max)
	DECLARE @ErrSeverity INT;
	DECLARE @intPointer INT;
	SET @ErrSeverity = 15; 

	BEGIN TRY

			EXEC sp_xml_preparedocument @intpointer OUTPUT,@xmlDoc
            DECLARE @RoleWiseStatusId bigint
			Declare @resourceId bigint

		
            UPDATE dbo.RoleWiseStatus SET
			@RoleWiseStatusId=tmp.RoleWiseStatusId,
        	StatusId=tmp.[StatusCode]   ,
        	RoleId=tmp.RoleMasterId,
			ResourceKey=tmp.ResourceKey,
			Class=tmp.Class
            FROM OPENXML(@intpointer,'Json/ActivityList',2)
			WITH
			(
			RoleWiseStatusId bigint,
            [StatusCode] bigint  ,       
            RoleMasterId bigint,
			ResourceKey nvarchar(150),
			Class nvarchar(100)
            )tmp WHERE RoleWiseStatus.RoleWiseStatusId=tmp.RoleWiseStatusId



			 UPDATE dbo.Resources SET
			@resourceId=tmp1.ResourceId,        	
        	ResourceValue= (Case  when (select top 1 ResourceValue from Resources where ResourceKey=tmp1.ResourceKey order by 1 desc) is null 
then (select top 1 ResourceValue from Resources where ResourceKey=tmp1.ResourceKey ) else tmp1.ResourceValue end)
			
            FROM OPENXML(@intpointer,'Json/ActivityList/CultureList',2)
			WITH
			(
			ResourceId bigint,            
			ResourceValue nvarchar(150),
			ResourceKey nvarchar(150)
            )tmp1 WHERE Resources.ResourceId=tmp1.ResourceId



			


			 
			--DELETE dbo.EmailRecepient WHERE IsActive=0


           SELECT @RoleWiseStatusId as RoleWiseStatusId FOR XML RAW('Json'),ELEMENTS
            exec sp_xml_removedocument @intPointer
		END TRY
		BEGIN CATCH
		SELECT @ErrMsg = ERROR_MESSAGE();
		RAISERROR(@ErrMsg, @ErrSeverity, 1);
		RETURN; 
		END CATCH
END

PRINT 'Successfully created procedure dbo.USP_EmailContent'